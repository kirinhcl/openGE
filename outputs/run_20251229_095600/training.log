2025-12-29 09:56:00,708 - __main__ - INFO - ======================================================================
2025-12-29 09:56:00,708 - __main__ - INFO - Starting G×E Crop Trait Prediction Training
2025-12-29 09:56:00,708 - __main__ - INFO - ======================================================================
2025-12-29 09:56:00,710 - __main__ - INFO - Loaded configuration from configs/maize_2024.yaml
2025-12-29 09:56:00,710 - __main__ - INFO - Using device: mps
2025-12-29 09:56:00,710 - __main__ - INFO - Loading data from ./Training_data
2025-12-29 09:56:00,710 - __main__ - INFO - Loading genetic data...
2025-12-29 09:56:01,664 - __main__ - INFO - Genetic data shape: (5899, 2397)
2025-12-29 09:56:01,664 - __main__ - INFO - Loading environment data...
2025-12-29 09:56:01,692 - __main__ - INFO - Environment data shape: (167, 684)
2025-12-29 09:56:01,692 - __main__ - INFO - Loading phenotype data...
2025-12-29 09:56:01,964 - __main__ - INFO - Phenotype data shape: (164921, 1)
2025-12-29 09:56:01,964 - __main__ - INFO - Target traits: ['Yield_Mg_ha']
2025-12-29 09:56:01,964 - __main__ - INFO - Aligning samples...
2025-12-29 09:56:02,387 - __main__ - INFO - Aligned samples: 68558
2025-12-29 09:56:02,387 - __main__ - INFO - Preprocessing data...
2025-12-29 09:56:03,787 - __main__ - INFO - Dataset: 68558 samples, 2397 markers, 684 env features, 1 traits
2025-12-29 09:56:03,789 - __main__ - INFO - Data split: train=47990, val=10283, test=10285
2025-12-29 09:56:03,936 - __main__ - INFO - Building G×E model...
2025-12-29 09:56:03,995 - __main__ - INFO - Model built: 4,446,017 total parameters, 4,446,017 trainable
2025-12-29 09:56:04,505 - __main__ - INFO - 
Starting training for 100 epochs...
2025-12-29 09:56:04,505 - __main__ - INFO - Batch size: 64, Learning rate: 0.0005
2025-12-29 09:56:04,505 - __main__ - INFO - ----------------------------------------------------------------------
2025-12-29 09:56:19,142 - __main__ - INFO - Epoch   1/100 | Train Loss: 0.5463 | Val Loss: 0.4550 | Val R²: 0.5441 | Val RMSE: 0.6746
2025-12-29 09:56:19,303 - __main__ - INFO -   ✓ Saved best model (R²: 0.5441)
2025-12-29 09:56:33,397 - __main__ - INFO - Epoch   2/100 | Train Loss: 0.4568 | Val Loss: 0.4258 | Val R²: 0.5734 | Val RMSE: 0.6526
2025-12-29 09:56:33,496 - __main__ - INFO -   ✓ Saved best model (R²: 0.5734)
2025-12-29 09:56:47,293 - __main__ - INFO - Epoch   3/100 | Train Loss: 0.4350 | Val Loss: 0.4201 | Val R²: 0.5789 | Val RMSE: 0.6483
2025-12-29 09:56:47,394 - __main__ - INFO -   ✓ Saved best model (R²: 0.5789)
2025-12-29 09:57:01,571 - __main__ - INFO - Epoch   4/100 | Train Loss: 0.4271 | Val Loss: 0.4158 | Val R²: 0.5833 | Val RMSE: 0.6449
2025-12-29 09:57:01,702 - __main__ - INFO -   ✓ Saved best model (R²: 0.5833)
2025-12-29 09:57:15,446 - __main__ - INFO - Epoch   5/100 | Train Loss: 0.4146 | Val Loss: 0.4175 | Val R²: 0.5816 | Val RMSE: 0.6463
2025-12-29 09:57:29,164 - __main__ - INFO - Epoch   6/100 | Train Loss: 0.4134 | Val Loss: 0.4145 | Val R²: 0.5846 | Val RMSE: 0.6439
2025-12-29 09:57:29,283 - __main__ - INFO -   ✓ Saved best model (R²: 0.5846)
2025-12-29 09:57:43,094 - __main__ - INFO - Epoch   7/100 | Train Loss: 0.4070 | Val Loss: 0.4091 | Val R²: 0.5900 | Val RMSE: 0.6397
2025-12-29 09:57:43,219 - __main__ - INFO -   ✓ Saved best model (R²: 0.5900)
2025-12-29 09:57:56,962 - __main__ - INFO - Epoch   8/100 | Train Loss: 0.4063 | Val Loss: 0.4099 | Val R²: 0.5892 | Val RMSE: 0.6404
2025-12-29 09:58:10,628 - __main__ - INFO - Epoch   9/100 | Train Loss: 0.3992 | Val Loss: 0.4137 | Val R²: 0.5854 | Val RMSE: 0.6433
2025-12-29 09:58:24,245 - __main__ - INFO - Epoch  10/100 | Train Loss: 0.3960 | Val Loss: 0.4120 | Val R²: 0.5871 | Val RMSE: 0.6420
2025-12-29 09:58:37,853 - __main__ - INFO - Epoch  11/100 | Train Loss: 0.3911 | Val Loss: 0.4053 | Val R²: 0.5939 | Val RMSE: 0.6367
2025-12-29 09:58:37,976 - __main__ - INFO -   ✓ Saved best model (R²: 0.5939)
2025-12-29 09:58:51,675 - __main__ - INFO - Epoch  12/100 | Train Loss: 0.3897 | Val Loss: 0.4112 | Val R²: 0.5879 | Val RMSE: 0.6414
2025-12-29 09:59:05,486 - __main__ - INFO - Epoch  13/100 | Train Loss: 0.3871 | Val Loss: 0.4092 | Val R²: 0.5898 | Val RMSE: 0.6399
2025-12-29 09:59:19,228 - __main__ - INFO - Epoch  14/100 | Train Loss: 0.3839 | Val Loss: 0.4097 | Val R²: 0.5894 | Val RMSE: 0.6402
2025-12-29 09:59:32,988 - __main__ - INFO - Epoch  15/100 | Train Loss: 0.3848 | Val Loss: 0.4032 | Val R²: 0.5959 | Val RMSE: 0.6351
2025-12-29 09:59:33,115 - __main__ - INFO -   ✓ Saved best model (R²: 0.5959)
2025-12-29 09:59:46,799 - __main__ - INFO - Epoch  16/100 | Train Loss: 0.3794 | Val Loss: 0.4076 | Val R²: 0.5915 | Val RMSE: 0.6386
2025-12-29 10:00:00,421 - __main__ - INFO - Epoch  17/100 | Train Loss: 0.3770 | Val Loss: 0.4063 | Val R²: 0.5928 | Val RMSE: 0.6375
2025-12-29 10:00:14,119 - __main__ - INFO - Epoch  18/100 | Train Loss: 0.3754 | Val Loss: 0.4025 | Val R²: 0.5967 | Val RMSE: 0.6345
2025-12-29 10:00:14,237 - __main__ - INFO -   ✓ Saved best model (R²: 0.5967)
2025-12-29 10:00:28,032 - __main__ - INFO - Epoch  19/100 | Train Loss: 0.3740 | Val Loss: 0.4111 | Val R²: 0.5880 | Val RMSE: 0.6413
2025-12-29 10:00:41,688 - __main__ - INFO - Epoch  20/100 | Train Loss: 0.3720 | Val Loss: 0.4064 | Val R²: 0.5927 | Val RMSE: 0.6376
2025-12-29 10:00:56,225 - __main__ - INFO - Epoch  21/100 | Train Loss: 0.3721 | Val Loss: 0.4069 | Val R²: 0.5923 | Val RMSE: 0.6380
2025-12-29 10:01:10,853 - __main__ - INFO - Epoch  22/100 | Train Loss: 0.3683 | Val Loss: 0.4093 | Val R²: 0.5898 | Val RMSE: 0.6399
2025-12-29 10:01:26,453 - __main__ - INFO - Epoch  23/100 | Train Loss: 0.3677 | Val Loss: 0.4111 | Val R²: 0.5880 | Val RMSE: 0.6413
2025-12-29 10:01:41,996 - __main__ - INFO - Epoch  24/100 | Train Loss: 0.3650 | Val Loss: 0.4057 | Val R²: 0.5935 | Val RMSE: 0.6370
2025-12-29 10:01:56,500 - __main__ - INFO - Epoch  25/100 | Train Loss: 0.3572 | Val Loss: 0.4079 | Val R²: 0.5913 | Val RMSE: 0.6387
2025-12-29 10:02:10,291 - __main__ - INFO - Epoch  26/100 | Train Loss: 0.3545 | Val Loss: 0.4044 | Val R²: 0.5948 | Val RMSE: 0.6360
2025-12-29 10:02:23,975 - __main__ - INFO - Epoch  27/100 | Train Loss: 0.3509 | Val Loss: 0.4050 | Val R²: 0.5941 | Val RMSE: 0.6365
2025-12-29 10:02:37,721 - __main__ - INFO - Epoch  28/100 | Train Loss: 0.3508 | Val Loss: 0.4070 | Val R²: 0.5921 | Val RMSE: 0.6381
2025-12-29 10:02:51,792 - __main__ - INFO - Epoch  29/100 | Train Loss: 0.3504 | Val Loss: 0.4084 | Val R²: 0.5907 | Val RMSE: 0.6392
2025-12-29 10:03:06,289 - __main__ - INFO - Epoch  30/100 | Train Loss: 0.3484 | Val Loss: 0.4046 | Val R²: 0.5945 | Val RMSE: 0.6362
2025-12-29 10:03:21,036 - __main__ - INFO - Epoch  31/100 | Train Loss: 0.3408 | Val Loss: 0.4105 | Val R²: 0.5886 | Val RMSE: 0.6408
2025-12-29 10:03:34,985 - __main__ - INFO - Epoch  32/100 | Train Loss: 0.3403 | Val Loss: 0.4079 | Val R²: 0.5913 | Val RMSE: 0.6387
2025-12-29 10:03:48,824 - __main__ - INFO - Epoch  33/100 | Train Loss: 0.3389 | Val Loss: 0.4081 | Val R²: 0.5910 | Val RMSE: 0.6389
2025-12-29 10:04:02,607 - __main__ - INFO - Epoch  34/100 | Train Loss: 0.3388 | Val Loss: 0.4070 | Val R²: 0.5922 | Val RMSE: 0.6380
2025-12-29 10:04:16,163 - __main__ - INFO - Epoch  35/100 | Train Loss: 0.3379 | Val Loss: 0.4130 | Val R²: 0.5861 | Val RMSE: 0.6428
2025-12-29 10:04:29,749 - __main__ - INFO - Epoch  36/100 | Train Loss: 0.3365 | Val Loss: 0.4102 | Val R²: 0.5889 | Val RMSE: 0.6406
2025-12-29 10:04:43,578 - __main__ - INFO - Epoch  37/100 | Train Loss: 0.3332 | Val Loss: 0.4102 | Val R²: 0.5889 | Val RMSE: 0.6406
2025-12-29 10:04:57,755 - __main__ - INFO - Epoch  38/100 | Train Loss: 0.3314 | Val Loss: 0.4106 | Val R²: 0.5885 | Val RMSE: 0.6409
2025-12-29 10:04:57,755 - __main__ - INFO - 
Early stopping triggered at epoch 38
2025-12-29 10:04:57,755 - __main__ - INFO - ----------------------------------------------------------------------
2025-12-29 10:04:57,755 - __main__ - INFO - Training completed! Best validation R²: 0.5967
2025-12-29 10:04:58,856 - __main__ - INFO - 
Test Set Performance:
2025-12-29 10:04:58,857 - __main__ - INFO -   - Loss: 0.3986
2025-12-29 10:04:58,857 - __main__ - INFO -   - R²: 0.6064
2025-12-29 10:04:58,857 - __main__ - INFO -   - RMSE: 0.6313
2025-12-29 10:04:58,861 - __main__ - INFO - 
Results saved to outputs/run_20251229_095600
2025-12-29 10:04:58,861 - __main__ - INFO - ======================================================================
