2025-12-29 09:47:14,457 - __main__ - INFO - ======================================================================
2025-12-29 09:47:14,458 - __main__ - INFO - Starting G×E Crop Trait Prediction Training
2025-12-29 09:47:14,458 - __main__ - INFO - ======================================================================
2025-12-29 09:47:14,460 - __main__ - INFO - Loaded configuration from configs/maize_2024.yaml
2025-12-29 09:47:14,474 - __main__ - INFO - Using device: mps
2025-12-29 09:47:14,474 - __main__ - INFO - Loading data from ./Training_data
2025-12-29 09:47:14,474 - __main__ - INFO - Loading genetic data...
2025-12-29 09:47:15,562 - __main__ - INFO - Genetic data shape: (5899, 2397)
2025-12-29 09:47:15,562 - __main__ - INFO - Loading environment data...
2025-12-29 09:47:15,592 - __main__ - INFO - Environment data shape: (167, 684)
2025-12-29 09:47:15,592 - __main__ - INFO - Loading phenotype data...
2025-12-29 09:47:15,881 - __main__ - INFO - Phenotype data shape: (164921, 1)
2025-12-29 09:47:15,881 - __main__ - INFO - Target traits: ['Yield_Mg_ha']
2025-12-29 09:47:15,881 - __main__ - INFO - Aligning samples...
2025-12-29 09:47:16,359 - __main__ - INFO - Aligned samples: 68558
2025-12-29 09:47:16,359 - __main__ - INFO - Preprocessing data...
2025-12-29 09:47:18,010 - __main__ - INFO - Dataset: 68558 samples, 2397 markers, 684 env features, 1 traits
2025-12-29 09:47:18,012 - __main__ - INFO - Data split: train=47990, val=10283, test=10285
2025-12-29 09:47:18,195 - __main__ - INFO - Building G×E model...
2025-12-29 09:47:18,269 - __main__ - INFO - Model built: 4,446,017 total parameters, 4,446,017 trainable
2025-12-29 09:47:18,903 - __main__ - INFO - 
Starting training for 3 epochs...
2025-12-29 09:47:18,903 - __main__ - INFO - Batch size: 64, Learning rate: 0.0005
2025-12-29 09:47:18,903 - __main__ - INFO - ----------------------------------------------------------------------
2025-12-29 09:47:36,609 - __main__ - INFO - Epoch   1/3 | Train Loss: 0.5424 | Val Loss: 0.4612 | Val R²: 0.5379 | Val RMSE: 0.6791
2025-12-29 09:47:36,768 - __main__ - INFO -   ✓ Saved best model (R²: 0.5379)
2025-12-29 09:47:53,359 - __main__ - INFO - Epoch   2/3 | Train Loss: 0.4522 | Val Loss: 0.4320 | Val R²: 0.5671 | Val RMSE: 0.6574
2025-12-29 09:47:53,490 - __main__ - INFO -   ✓ Saved best model (R²: 0.5671)
2025-12-29 09:48:10,012 - __main__ - INFO - Epoch   3/3 | Train Loss: 0.4358 | Val Loss: 0.4214 | Val R²: 0.5777 | Val RMSE: 0.6493
2025-12-29 09:48:10,140 - __main__ - INFO -   ✓ Saved best model (R²: 0.5777)
2025-12-29 09:48:10,140 - __main__ - INFO - ----------------------------------------------------------------------
2025-12-29 09:48:10,141 - __main__ - INFO - Training completed! Best validation R²: 0.5777
2025-12-29 09:48:11,430 - __main__ - INFO - 
Test Set Performance:
2025-12-29 09:48:11,430 - __main__ - INFO -   - Loss: 0.4114
2025-12-29 09:48:11,430 - __main__ - INFO -   - R²: 0.5938
2025-12-29 09:48:11,430 - __main__ - INFO -   - RMSE: 0.6413
2025-12-29 09:48:11,434 - __main__ - INFO - 
Results saved to outputs/run_20251229_094714
2025-12-29 09:48:11,434 - __main__ - INFO - ======================================================================
