2025-12-28 15:54:09,514 - __main__ - INFO - ======================================================================
2025-12-28 15:54:09,515 - __main__ - INFO - Starting G×E Crop Trait Prediction Training
2025-12-28 15:54:09,516 - __main__ - INFO - ======================================================================
2025-12-28 15:54:09,516 - __main__ - INFO - Using default configuration
2025-12-28 15:54:09,529 - __main__ - INFO - Using device: mps
2025-12-28 15:54:09,529 - __main__ - INFO - Loading data from ./Training_data
2025-12-28 15:54:09,529 - __main__ - INFO - Loading genetic data...
2025-12-28 15:54:10,531 - __main__ - INFO - Genetic data shape: (5899, 2397)
2025-12-28 15:54:10,532 - __main__ - INFO - Loading environment data...
2025-12-28 15:54:10,558 - __main__ - INFO - Environment data shape: (167, 684)
2025-12-28 15:54:10,558 - __main__ - INFO - Loading phenotype data...
2025-12-28 15:54:10,842 - __main__ - INFO - Phenotype data shape: (164921, 1)
2025-12-28 15:54:10,842 - __main__ - INFO - Target traits: ['Yield_Mg_ha']
2025-12-28 15:54:10,842 - __main__ - INFO - Aligning samples...
2025-12-28 15:54:11,360 - __main__ - INFO - Aligned samples: 68558
2025-12-28 15:54:11,360 - __main__ - INFO - Preprocessing data...
2025-12-28 15:54:12,952 - __main__ - INFO - Dataset: 68558 samples, 2397 markers, 684 env features, 1 traits
2025-12-28 15:54:12,954 - __main__ - INFO - Data split: train=47990, val=10283, test=10285
2025-12-28 15:54:13,145 - __main__ - INFO - Building G×E model...
2025-12-28 15:54:13,188 - __main__ - INFO - Model built: 2,547,841 total parameters, 2,547,841 trainable
2025-12-28 15:54:13,777 - __main__ - INFO - 
Starting training for 5 epochs...
2025-12-28 15:54:13,777 - __main__ - INFO - Batch size: 64, Learning rate: 0.001
2025-12-28 15:54:13,777 - __main__ - INFO - ----------------------------------------------------------------------
2025-12-28 15:54:34,824 - __main__ - INFO - Epoch   1/5 | Train Loss: 0.5160 | Val Loss: 0.4455 | Val R²: 0.5534 | Val RMSE: 0.6677
2025-12-28 15:54:34,941 - __main__ - INFO -   ✓ Saved best model (R²: 0.5534)
2025-12-28 15:54:49,669 - __main__ - INFO - Epoch   2/5 | Train Loss: 0.4473 | Val Loss: 0.4273 | Val R²: 0.5717 | Val RMSE: 0.6539
2025-12-28 15:54:49,761 - __main__ - INFO -   ✓ Saved best model (R²: 0.5717)
2025-12-28 15:55:05,036 - __main__ - INFO - Epoch   3/5 | Train Loss: 0.4332 | Val Loss: 0.4276 | Val R²: 0.5715 | Val RMSE: 0.6540
2025-12-28 15:55:20,000 - __main__ - INFO - Epoch   4/5 | Train Loss: 0.4176 | Val Loss: 0.4237 | Val R²: 0.5753 | Val RMSE: 0.6511
2025-12-28 15:55:20,093 - __main__ - INFO -   ✓ Saved best model (R²: 0.5753)
2025-12-28 15:55:34,800 - __main__ - INFO - Epoch   5/5 | Train Loss: 0.4115 | Val Loss: 0.4136 | Val R²: 0.5855 | Val RMSE: 0.6433
2025-12-28 15:55:34,888 - __main__ - INFO -   ✓ Saved best model (R²: 0.5855)
2025-12-28 15:55:34,888 - __main__ - INFO - ----------------------------------------------------------------------
2025-12-28 15:55:34,888 - __main__ - INFO - Training completed! Best validation R²: 0.5855
2025-12-28 15:55:36,118 - __main__ - INFO - 
Test Set Performance:
2025-12-28 15:55:36,118 - __main__ - INFO -   - Loss: 0.4037
2025-12-28 15:55:36,118 - __main__ - INFO -   - R²: 0.6014
2025-12-28 15:55:36,118 - __main__ - INFO -   - RMSE: 0.6353
2025-12-28 15:55:36,123 - __main__ - INFO - 
Results saved to outputs/run_20251228_155409
2025-12-28 15:55:36,123 - __main__ - INFO - ======================================================================
